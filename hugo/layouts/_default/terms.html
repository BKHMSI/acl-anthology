{{ define "javascript" }}
<script>

    function clearSearch(){
        document.getElementById('lang_query').value = "";
        filterTerms();
    }
    
    function filterTerms(){
        let query = document.getElementById('lang_query').value;
        var table = document.getElementById('term_content');
        let flag = query.trim() == '';
        for (var i = 1, row; row = table.rows[i]; i+=6) {
            let text = row.cells[0].innerHTML;
            if(flag && row.style.display == 'none'){
                for(var j = i; j<6+i; j++){
                    table.rows[j].style.display = '';
                }
            }else if(!text.includes(query)){
                for(var j = i; j<6+i; j++){
                    table.rows[j].style.display = 'none';
                }
            }
        }
    }

    $("#lang_query").on('keyup', function (event) {
      if (event.keyCode === 13) {
         filterTerms();
      }
   });


</script>
{{ end }}

{{ define "main" }}
<main aria-role="main">
  <h1 id="title">
    {{ .Title }}
  </h1>
  {{ with .Params.subtitle }}
  <p class="lead text-muted">{{ . }}</p>
  {{ end }}
  <hr />

  {{ if not .Date.IsZero }}
  <p class="font-weight-light font-italic text-muted">{{ .Date.Format "January 2, 2006" }}</p>
  {{ end }}

  <div class="input-group" style="padding:20px">
    <div class="form-outline">
      <input type="search" id="lang_query" class="form-control" placeholder="Search..." style="display:inline-block; width:80%"/>
        <button type="button" onclick="filterTerms()" class="btn btn-primary">Search
        <i class="fas fa-search"></i>
        </button>
        <button type="button" onclick="clearSearch()" class="btn btn-danger">Clear
        </button>
    </div>
  </div>

  <table class="table table-striped table-responsive-lg" id="term_content">
    <thead>
        <tr>
            <th scope="col"> Term </th>
            <th scope="col"> Frequency </th>
            <th scope="col"> Contexts </th>
        </tr>
    </thead>
    <tbody>
        {{ range .Site.Data.terms }}
            <tr>
                {{ if eq .wiki ""}}
                    <td rowspan="6"> {{ .term }} </td>
                {{else}}
                    <td rowspan="6"> <a href="{{.wiki}}"> {{ .term }} </a> </td>
                {{end}}
                <td rowspan="6"> {{ .frequency }} </td>
            </tr>
            {{ range .sentences}}
            <tr>
                <td> {{.sentence }} </td>
            </tr>
            {{end}}
        {{ end }}
    </tbody>

  </table>


</main>
{{ end }}
